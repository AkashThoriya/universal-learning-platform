{
  "id": "lld_low_level_design",
  "name": "Low Level Design (Object-Oriented Design)",
  "description": "Comprehensive Low Level Design course covering SOLID principles, design patterns, UML diagrams, and real-world case studies like Parking Lot, BookMyShow, and Splitwise. Master object-oriented design for technical interviews.",
  "category": "Computer Science",
  "totalEstimatedHours": 55,
  "resources": [
    "https://refactoring.guru/design-patterns",
    "https://github.com/tssovi/grokking-the-object-oriented-design-interview"
  ],
  "stages": [
    {
      "id": "foundation",
      "name": "LLD Foundation Assessment",
      "totalMarks": 100,
      "duration": 180,
      "sections": [
        {
          "id": "solid",
          "name": "SOLID Principles",
          "maxMarks": 25,
          "maxTime": 45,
          "negativeMarking": 0
        },
        {
          "id": "creational",
          "name": "Creational Patterns",
          "maxMarks": 25,
          "maxTime": 45,
          "negativeMarking": 0
        },
        {
          "id": "structural",
          "name": "Structural Patterns",
          "maxMarks": 25,
          "maxTime": 45,
          "negativeMarking": 0
        },
        {
          "id": "behavioral",
          "name": "Behavioral Patterns",
          "maxMarks": 25,
          "maxTime": 45,
          "negativeMarking": 0
        }
      ]
    },
    {
      "id": "advanced",
      "name": "Advanced LLD Assessment",
      "totalMarks": 150,
      "duration": 270,
      "sections": [
        {
          "id": "case_studies",
          "name": "Case Studies",
          "maxMarks": 50,
          "maxTime": 90,
          "negativeMarking": 0
        },
        {
          "id": "concurrency",
          "name": "Concurrency & Threading",
          "maxMarks": 50,
          "maxTime": 90,
          "negativeMarking": 0
        },
        {
          "id": "uml",
          "name": "UML & System Modeling",
          "maxMarks": 50,
          "maxTime": 90,
          "negativeMarking": 0
        }
      ]
    }
  ],
  "defaultSyllabus": [
    {
      "id": "solid_principles",
      "name": "SOLID Principles",
      "tier": 1,
      "estimatedHours": 2,
      "topics": [
        {
          "id": "solid_principles_topic",
          "name": "SOLID Principles",
          "estimatedHours": 2,
          "description": "Master the five fundamental principles of object-oriented design that lead to maintainable, flexible, and understandable code. These principles form the foundation of all good software architecture.",
          "practiceQuestions": [
            {
              "name": "Design Browser History",
              "slug": "design-browser-history",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/design-browser-history/"
            }
          ],
          "learningTip": [
            "**Single Responsibility Principle (SRP):** ONE reason to change. Separate `UserAuth` from `UserProfile`. Don't mix logic.",
            "**Open/Closed Principle (OCP):** Extend functionality via subclasses/interfaces, DO NOT modify existing tested code.",
            "**Liskov Substitution Principle (LSP):** Derived classes must be essentially 'is-a' substitutes. No 'NotImplementedExceptions'.",
            "**Interface Segregation Principle (ISP):** Client shouldn't depend on methods it doesn't use. Split `Worker` into `Eater` and `Worker`.",
            "**Dependency Inversion Principle (DIP):** High-level modules depend on Abstractions (Interfaces), not concrete Low-level details."
          ],
          "mustNotMiss": [
            "**SRP Violation:** `Invoice` class calculating tax AND saving to DB. Split into `InvoiceCalculator` and `InvoiceRepository`.",
            "**OCP Example:** Strategy Pattern. Add new `PaymentStrategy` without touching `PaymentProcessor`.",
            "**LSP Violation:** `Square` extends `Rectangle`. `setWidth` changes height. Breaks assumptions.",
            "**ISP Example:** `java.util.List` vs `java.util.Deque`. Use specific interface for specific needs.",
            "**DIP Implementation:** Dependency Injection (Spring/Guice). Inject `Database` interface, pass `MySQLDatabase` at runtime."
          ],
          "resources": [
            "https://www.baeldung.com/solid-principles",
            "https://refactoring.guru/design-patterns"
          ],
          "interviewQuestions": [
            {
              "question": "Explain the Liskov Substitution Principle with a real example.",
              "answer": "**Definition:** Subtypes must be substitutable for their base types without breaking the application. \n**Violation:** `Square` extends `Rectangle`. Setting `width` on Square changes `height` too. \n`Rectangle r = new Square(); r.setWidth(5); r.setHeight(10);` -> Area should be 50, but Square makes it 100. **Bad Design.**"
            },
            {
              "question": "How does Dependency Inversion help in writing testable code?",
              "answer": "**Decoupling:** High-level modules (Business Logic) shouldn't depend on Low-level modules (DB/API), but on **Abstractions (Interfaces)**. \n**Testing:** Allows mocking. instead of `new MySQLDatabase()`, inject `Database` interface. In tests, inject `MockDatabase`."
            },
            {
              "question": "Give an example of Open/Closed Principle in a payment system.",
              "answer": "**Closed:** `PaymentService` code shouldn't change when adding new methods. \n**Open:** Create interface `PaymentMethod`. Implement `CreditCardPayment`, `UPIPayment`. \nTo add `BitcoinPayment`, just create a new class implementing the interface. *No existing code is touched.*"
            },
            {
              "question": "Why is Interface Segregation important for large interfaces?",
              "answer": "**Fat Interfaces** force clients to implement methods they don't use (e.g., `Fax()` in a `Printer` interface). \n**Fix:** Split into `Printable`, `Scanable`, `Faxable`. \n*Result:* Classes only implement what they need, reducing side effects and recompilation/redeployment risks."
            },
            {
              "question": "Show how Single Responsibility applies to a UserController class.",
              "answer": "**Bad:** `UserController` handles Validations + Database + Email Sending. \n**Good:** \n1. `UserValidator` (Validate input). \n2. `UserService` (Business Logic). \n3. `UserRepository` (DB Access). \n4. `EmailService` (Notifications). \n*Each class has one reason to change.*"
            }
          ]
        }
      ]
    },
    {
      "id": "creational_patterns",
      "name": "Creational Design Patterns",
      "tier": 1,
      "estimatedHours": 8,
      "topics": [
        {
          "id": "singleton_pattern",
          "name": "Intro to Design Patterns + Singleton",
          "estimatedHours": 2,
          "description": "Introduction to design patterns and the Singleton pattern - ensuring a class has only one instance. Learn thread-safe implementations and when Singleton becomes an anti-pattern.",
          "practiceQuestions": [
            {
              "name": "Design Logger",
              "slug": "design-logger",
              "difficulty": "Easy",
              "link": "https://refactoring.guru/design-patterns/singleton"
            }
          ],
          "learningTip": [
            "**Singleton Purpose:** Ensure a class has only ONE instance and provide a global point of access.",
            "**Concurrency Risk:** Lazy initialization requires synchronization (Double-Checked Locking).",
            "**Testing Pain:** Singletons behave like global state, making unit tests hard to isolate. Use DI instead where possible.",
            "**Enum Singleton:** The most robust way to implement Singleton in Java (References: Effective Java)."
          ],
          "mustNotMiss": [
            "**Double-Checked Locking:** `if (instance == null) synchronized { if (instance == null) instance = new ... }`",
            "**Bill Pugh Singleton:** Uses static inner helper class <code>SingletonHelper</code>. loaded lazily.",
            "**Serialization Safety:** define `readResolve()` to prevent new instance creation during deserialization.",
            "**Anti-Pattern:** When used as a replacement for global variables. Breaks modularity."
          ],
          "resources": [
            "https://refactoring.guru/design-patterns/singleton",
            "https://www.geeksforgeeks.org/java-singleton-design-pattern-practices-examples/"
          ],
          "interviewQuestions": [
            {
              "question": "Implement a Thread-Safe Singleton (Double-Checked Locking).",
              "answer": "```java\nclass Singleton {\n  private static volatile Singleton instance;\n  private Singleton() {}\n  public static Singleton getInstance() {\n    if (instance == null) {\n      synchronized (Singleton.class) {\n        if (instance == null) instance = new Singleton();\n      }\n    }\n    return instance;\n  }\n}\n```\n*Note: `volatile` prevents instruction reordering.*"
            },
            {
              "question": "When is Singleton an anti-pattern?",
              "answer": "1. **Global State:** Hides dependencies, making code hard to trace. \n2. **Testing:** Hard to mock in unit tests (cannot reset state between tests). \n3. **Concurrency:** Can become a bottleneck if not implemented carefully. \n**Better:** Use Dependency Injection (Spring/Guice) to manage scope."
            },
            {
              "question": "How does Enum Singleton solve serialization issues?",
              "answer": "Java Enums are **guaranteed** to be singletons by the JVM (handled internally). \nRegular Singletons need `readResolve()` to prevent creating new instances during Deserialization. Enums handle this automatically and are also Reflection-safe."
            },
            {
              "question": "Singleton vs Static class - when to use which?",
              "answer": "**Singleton:** Is an **Object**. Can implement interfaces, pass as a parameter, be lazy-loaded, and handled mostly by DI frameworks. \n**Static Class:** Just a bag of functions (Utils). Cannot be passed around, harder to mock, eager loaded by ClassLoader."
            },
            {
              "question": "How does Singleton affect unit testing?",
              "answer": "It introduces **Hidden Dependencies**. \nIf Class A calls `Singleton.getInstance()`, you cannot easily swap it with a `MockSingleton`. \nIt also carries **State** across tests, causing flaky tests (Test B fails only if Test A runs first)."
            }
          ]
        },
        {
          "id": "builder_pattern",
          "name": "Builder Pattern",
          "estimatedHours": 2,
          "description": "Master the Builder pattern for constructing complex objects step-by-step. Especially useful when objects have many optional parameters.",
          "practiceQuestions": [
            {
              "name": "Builder Pattern Practice",
              "slug": "builder-pattern",
              "difficulty": "Medium",
              "link": "https://refactoring.guru/design-patterns/builder"
            }
          ],
          "learningTip": [
            "**Builder Purpose:** Construction of complex objects. Separates construction from representation.",
            "**Telescoping Constructor Problem:** Avoids `new Pizza(12, true, false, true, null...)` hell.",
            "**Immutability:** Builder is the best way to create immutable objects with many optional fields.",
            "**Fluent API:** Method chaining `builder.setHeader().setBody().build()` makes code readable."
          ],
          "mustNotMiss": [
            "**Director:** Optional class that defines order of construction steps for specific configurations.",
            "**Inner Static Class:** Builder is often a static inner class of the product to access private constructor.",
            "**Thread Safety:** The Builder itself is not thread-safe, but the object it builds IS thread-safe (Immutable).",
            "**Lombok:** `@Builder` annotation automates this pattern in Java."
          ],
          "resources": [
            "https://refactoring.guru/design-patterns/builder",
            "https://blogs.oracle.com/javamagazine/post/exploring-the-builder-design-pattern-in-java"
          ],
          "interviewQuestions": [
            {
              "question": "Use Builder pattern to design a Pizza Order class.",
              "answer": "```java\nPizza p = new Pizza.Builder()\n  .size(Size.LARGE)\n  .crust(\"Thin\")\n  .addTopping(\"Cheese\")\n  .addTopping(\"Olives\")\n  .build();\n```\nAvoids the 'Telescoping Constructor' problem (`new Pizza(L, Thin, true, true, false...)`)."
            },
            {
              "question": "Why use Builder instead of constructor with many parameters?",
              "answer": "1. **Readability:** `setSize(L)` is clearer than passing `L` as 3rd arg. \n2. **Optionality:** Don't need to pass `null` for optional fields. \n3. **Immutability:** The final object returned by `.build()` can be immutable (no setters)."
            },
            {
              "question": "How does Builder support immutable objects?",
              "answer": "The Builder class itself is mutable (has setters), but the `build()` method copies values into the target class's `private final` fields. The target class has **NO setters**, making it thread-safe and immutable."
            },
            {
              "question": "Difference between Builder and Factory?",
              "answer": "**Factory:** Creates objects in **one step**. Good for polymorphism (returning different subclasses). \n**Builder:** Creates objects in **multiple steps**. Good for complex configuration of a single class."
            },
            {
              "question": "When would you use a Director class with Builder?",
              "answer": "When you have **pre-defined configurations**. \n`Director.constructMargherita(builder)` -> Sets cheese, tomato. \n`Director.constructPepperoni(builder)` -> Sets meat, spicy. \nClient just calls the Director instead of setting manually."
            }
          ]
        },
        {
          "id": "factory_pattern",
          "name": "Factory Pattern",
          "estimatedHours": 2,
          "description": "Learn all variants of Factory pattern - Simple Factory, Factory Method, and Abstract Factory. Understand when to use each and their trade-offs.",
          "practiceQuestions": [
            {
              "name": "Factory Pattern Practice",
              "slug": "factory-pattern",
              "difficulty": "Medium",
              "link": "https://refactoring.guru/design-patterns/factory-method"
            }
          ],
          "learningTip": [
            "**Factory Method:** Defines interface for creating an object, but lets subclasses decide which class to instantiate.",
            "**Abstract Factory:** Creates families of related objects (e.g., MacButton, MacScrollbar) without specifying concrete classes.",
            "**Decoupling:** Client code works with `Button` interface, not `WindowsButton` implementation.",
            "**Dependency Injection:** A form of Factory pattern where the container (Spring) acts as the factory."
          ],
          "mustNotMiss": [
            "**Simple Factory:** Just a class with a static method. NOT a standard GoF pattern, but commonly used idiom.",
            "**Factory Method vs Abstract Factory:** Factory Method = Inheritance (Subclass decides). Abstract Factory = Composition (Factory object decides).",
            "**Open/Closed:** Add new product types by adding new Factories, without breaking existing client code.",
            "**Real World:** JDBC `DriverManager.getConnection()`, `Calendar.getInstance()`."
          ],
          "resources": [
            "https://refactoring.guru/design-patterns/factory-method",
            "https://refactoring.guru/design-patterns/abstract-factory"
          ],
          "interviewQuestions": [
            {
              "question": "Difference between Simple Factory, Factory Method, Abstract Factory.",
              "answer": "**Simple:** Single class with `if-else` to create objects. \n**Method:** Interface defines `create()`, Subclasses decide *what* to create. \n**Abstract:** Interface defines a *family* of create methods (`createChair`, `createTable`) to ensure products match (Modern/Victorian)."
            },
            {
              "question": "Design NotificationFactory for Email, SMS, Push.",
              "answer": "Use **Factory Method**. \n`NotificationFactory` (interface) -> `createNotification()`. \n`EmailFactory` returns `EmailNotification`. \n`SMSFactory` returns `SMSNotification`. \nClient code: `factory.createNotification().send()`."
            },
            {
              "question": "When would you choose Factory Method over Simple Factory?",
              "answer": "When you want to adhere to **Open/Closed Principle**. \nSimple Factory requires modifying the switch case to add a new type. \nFactory Method lets you just add a new `Factory` subclass without touching existing code."
            },
            {
              "question": "How does Abstract Factory support multiple product families?",
              "answer": "It ensures compatibility. \nIf you use `MacUIFactory`, you get `MacButton` AND `MacCheckbox`. \nYou cannot accidentally mix `MacButton` with `WindowsCheckbox`. The factory enforcing the 'theme' or 'family'."
            },
            {
              "question": "Design a factory for creating database connections.",
              "answer": "`ConnectionFactory` holds common logic (pool management). \n`createConnection(type)` returns `MySQLConnection` or `PostgresConnection`. \nOften implemented as a Singleton Factory or using Dependency Injection to supply the correct driver."
            }
          ]
        },
        {
          "id": "prototype_pattern",
          "name": "Prototype Pattern",
          "estimatedHours": 2,
          "description": "Learn the Prototype pattern for creating objects by cloning existing instances. Understand shallow vs deep copy and when to use this pattern.",
          "practiceQuestions": [
            {
              "name": "Copy List with Random Pointer",
              "slug": "copy-list-with-random-pointer",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/copy-list-with-random-pointer/"
            },
            {
              "name": "Clone Graph",
              "slug": "clone-graph",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/clone-graph/"
            }
          ],
          "learningTip": [
            "**Prototype Purpose:** Avoids costly creation (DB calls) by cloning existing objects in memory.",
            "**Shallow vs Deep:** Shallow copies references (dangerous for mutable fields). Deep copies values (safe).",
            "**Registry Pattern:** Often used with Prototype to cache commonly used objects by name (`mobs.get('Orc')`).",
            "**Java Cloneable:** The default `clone()` is shallow and tricky. Copy Constructors are often cleaner."
          ],
          "mustNotMiss": [
            "**Shallow Copy Trap:** Modifying a list in the clone modifies the list in the original if they share the reference.",
            "**Deep Copy Implementation:** Recursive cloning or Serialization/Deserialization (slower but easier).",
            "**Use Case:** Object creation involves complex calculations or network calls.",
            "**Real World:** Game Spawning (1000 bullets), Document Templates (Invoice Template)."
          ],
          "resources": [
            "https://refactoring.guru/design-patterns/prototype",
            "https://www.geeksforgeeks.org/prototype-design-pattern/"
          ],
          "interviewQuestions": [
            {
              "question": "When is deep copy preferred over shallow copy?",
              "answer": "When the object contains **mutable references** that should NOT be shared. \nExample: Copying a `GameLevel`. If you shallow copy, moving an enemy in the copy moves it in the original too (shared reference). Deep copy creates independent enemies."
            },
            {
              "question": "Implement Prototype pattern for a Game Character registry.",
              "answer": "1. `Character` implements `Cloneable`. \n2. `Registry` map keys (`'Warrior'`, `'Mage'`) to pre-configured instances. \n3. `registry.get('Warrior')` returns `prototypes.get('Warrior').clone()`. \n*Much faster than re-loading 3D assets from disk.*"
            },
            {
              "question": "How do you implement deep clone for complex objects?",
              "answer": "1. **Serialization:** Serialize to Byte Stream (JSON/Binary) and Deserialize back. (Easiest, slow). \n2. **Copy Constructor:** `new Car(otherCar)` recursively calls copy constructors of children. \n3. **Manual:** Override `clone()` to strictly new up nested objects."
            },
            {
              "question": "Prototype vs Factory - when to use which?",
              "answer": "**Factory:** When you want to create a brand new object from scratch. \n**Prototype:** When initialization is **expensive** (DB calls, parsing config) or when you want to copy an *existing state*."
            },
            {
              "question": "Challenges with cloning objects containing circular references?",
              "answer": "Infinite Recursion. \nA -> B -> A. \n**Fix:** Maintain a `Map<Original, Copy>` of visited objects during cloning. If an object is already in the map, return the existing copy."
            }
          ]
        }
      ]
    },
    {
      "id": "structural_behavioral_patterns",
      "name": "Structural & Behavioral Patterns",
      "tier": 1,
      "estimatedHours": 6,
      "topics": [
        {
          "id": "adapter_strategy",
          "name": "Adapter and Strategy Patterns",
          "estimatedHours": 2,
          "description": "Master Adapter for interface compatibility and Strategy for interchangeable algorithms. Two of the most commonly used patterns in real-world applications.",
          "practiceQuestions": [
            {
              "name": "Strategy Pattern Practice",
              "slug": "strategy-pattern",
              "difficulty": "Medium",
              "link": "https://refactoring.guru/design-patterns/strategy"
            }
          ],
          "learningTip": [
            "**Adapter:** Matches two incompatible interfaces. Think 'Travel Power Adapter'. Wraps the Adaptee.",
            "**Strategy:** Defines a family of interchangeable algorithms. Think 'Google Maps Route (Car, Walk, Bike)'.",
            "**Composition over Inheritance:** Both prefer containing the object rather than extending it.",
            "**Open/Closed:** precise application of OCP. Add new adapters/strategies without breaking client code."
          ],
          "mustNotMiss": [
            "**Adapter vs Decorator:** Adapter changes interface. Decorator stays same interface but adds behavior.",
            "**Class Adapter:** uses Inheritance (extends Old and New). Less flexible.",
            "**Object Adapter:** uses Composition (has instance of Old). More flexible, can adapt subclasses.",
            "**Strategy Context:** The class that uses the strategy. It doesn't know concrete details, just the interface."
          ],
          "resources": [
            "https://refactoring.guru/design-patterns/adapter",
            "https://refactoring.guru/design-patterns/strategy"
          ],
          "interviewQuestions": [
            {
              "question": "Use Adapter to connect PaymentProcessor to 3rd party API.",
              "answer": "**Context:** `MyApp` uses `IPayment`. `Stripe` has incompatible methods. \n**Solution:** Create `StripeAdapter implements IPayment`. \nInside `pay(amount)`, call `stripe.makeCharge(amount)`. \n*Result:* Client code (`MyApp`) stays unchanged."
            },
            {
              "question": "Design Navigation app using Strategy (Car, Walk, Transit routes).",
              "answer": "**Interface:** `RouteStrategy { buildRoute(A, B); }` \n**Implementations:** `CarStrategy`, `WalkStrategy`, `TransitStrategy`. \n**Context:** `Navigator` class holds a reference to `RouteStrategy`. \n*Benefit:* Can switch mode at runtime without `if-else` blocks in Navigator."
            },
            {
              "question": "When would you choose Adapter over modifying original class?",
              "answer": "1. **Third-party code:** You *can't* modify the library. \n2. **Legacy code:** Risk of breaking existing functionality is high. \n3. **SRP:** The conversion logic belongs in a separate adapter, not the core class."
            },
            {
              "question": "How does Strategy support Open/Closed principle?",
              "answer": "To add a new strategy (e.g., `BikeRoute`), you create a new class `BikeStrategy` implementing the interface. \nThe `Navigator` (Context) class logic remains **Closed** to modification. It just accepts the new strategy object."
            },
            {
              "question": "Real-world examples of Strategy pattern?",
              "answer": "1. **Collections.sort():** Takes a `Comparator` (Strategy) to define sorting logic. \n2. **Payment Processing:** Switching between CreditCard/PayPal at checkout. \n3. **Compression:** ZIP, RAR, GZIP strategies for file archiver."
            }
          ]
        },
        {
          "id": "observer_decorator",
          "name": "Observer and Decorator Patterns",
          "estimatedHours": 2,
          "description": "Learn Observer for event-driven systems and Decorator for dynamic behavior addition. Critical patterns for UI frameworks and middleware.",
          "practiceQuestions": [
            {
              "name": "Design Notification System",
              "slug": "design-notification",
              "difficulty": "Medium",
              "link": "https://refactoring.guru/design-patterns/observer"
            }
          ],
          "learningTip": [
            "**Observer Purpose:** One-to-Many dependency. When Subject changes, all Dependents are notified.",
            "**Decorator Purpose:** Add responsibilities dynamically. Flexible alternative to subclassing.",
            "**Loose Coupling:** Subject (Publisher) doesn't know concrete details of Observer (Subscriber).",
            "**Recursive Composition:** Decorators can wrap other decorators (`BufferedInputStream(FileInputStream)`)."
          ],
          "mustNotMiss": [
            "**Observer Memory Leak:** If observers aren't removed, they stay in memory (Lapsed Listener Problem).",
            "**Push vs Pull:** Push sends data in payload (`update(data)`). Pull notifies change, observer fetches (`subject.getData()`).",
            "**Decorator Order:** Order of wrapping matters! `Encrypt(Compress(Data))` != `Compress(Encrypt(Data))`.",
            "**Real World:** React `useEffect` (Observer), Java I/O Streams (Decorator)."
          ],
          "resources": [
            "https://refactoring.guru/design-patterns/observer",
            "https://refactoring.guru/design-patterns/decorator"
          ],
          "interviewQuestions": [
            {
              "question": "Design Weather Station with Observer pattern.",
              "answer": "**Subject (Publisher):** `WeatherData`. Has list of observers. Methods: `register()`, `remove()`, `notify()`. \n**Observers (Subscribers):** `PhoneDisplay`, `WindowDisplay`, `LogService`. \n**Flow:** When temperature changes, `WeatherData` calls `update(temp)` on all observers."
            },
            {
              "question": "Use Decorator for Coffee with add-ons (Milk, Sugar, Cream).",
              "answer": "Base: `SimpleCoffee` (cost: $5). \nDecorator: `Milk` (cost: +$1, wraps Coffee). \nCost calculation is recursive: `Milk.cost()` -> `1 + wrappedCoffee.cost()`. \nUsage: `new Milk(new Sugar(new SimpleCoffee()))`."
            },
            {
              "question": "How does Decorator differ from inheritance?",
              "answer": "**Inheritance:** Static. You'd need `MilkCoffee`, `SugarCoffee`, `MilkSugarCoffee` classes (Explosion!). \n**Decorator:** Dynamic. You mix and match wrappers at **runtime**. `new Milk(new Sugar(coffee))`."
            },
            {
              "question": "Push vs Pull in Observer pattern?",
              "answer": "**Push:** Subject sends all data in notify (`update(temp, humidity, pressure)`). *Pros:* Observer has data immediately. *Cons:* Might send unused data. \n**Pull:** Subject just notifies (`update()`). Observer calls `subject.getTemp()` to fetch what it needs."
            },
            {
              "question": "How is Decorator used in Java I/O streams?",
              "answer": "`BufferedReader` wraps `FileReader`. \n`new BufferedReader(new FileReader(\"file.txt\"))`. \n`FileReader` reads bytes. `BufferedReader` adds buffering capability (performance). \n`GZIPInputStream` adds decompression."
            }
          ]
        },
        {
          "id": "facade_proxy_chain",
          "name": "Facade, Proxy, and Chain of Responsibility",
          "estimatedHours": 2,
          "description": "Learn three powerful patterns - Facade for simplified interfaces, Proxy for controlled access, and Chain of Responsibility for request handling pipelines.",
          "practiceQuestions": [
            {
              "name": "Chain of Responsibility Practice",
              "slug": "chain-of-responsibility",
              "difficulty": "Medium",
              "link": "https://refactoring.guru/design-patterns/chain-of-responsibility"
            }
          ],
          "learningTip": [
            "**Facade:** Provides a simple interface to a complex system. Think 'One button to start car' (instead of ignition, fuel injection, etc).",
            "**Proxy:** Controls access to an object. Think 'Security Guard' or 'Cache'.",
            "**Chain of Responsibility:** Passes request along a chain. Each handler decides to process or pass.",
            "**Separation of Concerns:** Chain decouples sender from receiver."
          ],
          "mustNotMiss": [
            "**Facade vs Adapter:** Facade *simplifies* interface (new). Adapter *converts* interface (compatibility).",
            "**Proxy Types:** Remote Proxy (RPC), Virtual Proxy (Lazy Load), Protection Proxy (Auth), Smart Reference (Counting).",
            "**Chain Pitfall:** Request might fall off the end of the chain unhandled. Always have a default handler.",
            "**Real World:** SLF4J (Facade for logging), Hibernate Lazy Loading (Virtual Proxy), Servlet Filters (Chain)."
          ],
          "resources": [
            "https://refactoring.guru/design-patterns/proxy",
            "https://refactoring.guru/design-patterns/chain-of-responsibility"
          ],
          "interviewQuestions": [
            {
              "question": "Use Facade to simplify Video Conversion library.",
              "answer": "**Problem:** Client needs to call `CodecFactory`, `BitrateReader`, `AudioMixer`, `OggCompressor`. \n**Facade:** `VideoConverter` class with one method: `convert(filename, format)`. \nIt orchestrates the complex calls internally. Client sees simple API."
            },
            {
              "question": "Use Proxy for access control/logging on Database.",
              "answer": "`DatabaseProxy` implements `Database`. \nIn `query()` method: \n1. Check specific logic (Validation, Security Role). \n2. Log the query start time. \n3. Call `realDatabase.query()`. \n4. Log end time."
            },
            {
              "question": "Design Logger (Info → Debug → Error) with Chain of Responsibility.",
              "answer": "`LogHandler` with `next` pointer. \n`InfoHandler` -> `DebugHandler` -> `ErrorHandler`. \nmsg(INFO) handled by InfoHandler. \nmsg(ERROR) passed down: Info(skip) -> Debug(skip) -> Error(handle/print)."
            },
            {
              "question": "When to use Proxy vs Decorator?",
              "answer": "**Proxy:** Controls access (Security, Lazy Loading, Remote). Same interface, usually manages functionality *not visible* to user. \n**Decorator:** Adds behavior/responsibility (UI borders, Scrollbars). enhances the object's core functionality."
            },
            {
              "question": "How is Chain used in servlet filters?",
              "answer": "In Java Web Apps, a request passes through a chain of filters (Auth, Logging, Compression) before hitting the Servlet. \n`filterChain.doFilter(req, resp)` passes control to the next filter. If one blocks it (e.g. Auth fails), request stops."
            }
          ]
        }
      ]
    },
    {
      "id": "uml_interviews",
      "name": "UML & Interview Approach",
      "tier": 2,
      "estimatedHours": 4,
      "topics": [
        {
          "id": "uml_diagrams",
          "name": "UML Diagrams",
          "estimatedHours": 2,
          "description": "Master UML diagrams for communicating designs - Class diagrams for structure, Sequence diagrams for interactions, and Use Case diagrams for requirements.",
          "practiceQuestions": [
            {
              "name": "UML Diagram Practice",
              "slug": "uml-diagrams",
              "difficulty": "Medium",
              "link": "https://www.uml-diagrams.org/"
            }
          ],
          "learningTip": [
            "**Class Diagram:** Static structure. Shows classes, attributes, methods, and relationships. The 'Skeleton'.",
            "**Sequence Diagram:** Dynamic behavior. Shows how objects interact over time. The 'Flow'.",
            "**Use Case Diagram:** Functional requirements. Shows Actors and System boundaries. The 'Scope'.",
            "**Timing:** Don't waste time on perfect syntax. Focus on clarity and correct relationships."
          ],
          "mustNotMiss": [
            "**Class Relationships:** Association (Line), Aggregation (Empty Diamond), Composition (Filled Diamond), Inheritance (Triangle).",
            "**Aggregation vs Composition:** Car has Wheels (Composition - strong). Library has Members (Aggregation - weak).",
            "**Sequence Diagram Lifelines:** Vertical dashed lines representing object existence.",
            "**Multiplicity:** `1` (One), `*` (Many), `0..1` (Optional). Crucial for database design."
          ],
          "resources": [
            "https://www.uml-diagrams.org/class-diagrams-overview.html",
            "https://www.uml-diagrams.org/sequence-diagrams.html"
          ],
          "interviewQuestions": [
            {
              "question": "Draw Class Diagram for Library Management System.",
              "answer": "**Classes:** `Book`, `Member`, `Librarian`, `Loan`. \n**Relationships:** \n- `Library` **has-a** `Book` (Aggregation). \n- `Loan` **associates** `Member` and `Book`. \n- `Librarian` **inherits** `Account`. \n*Key:* Show cardinality (1 Member -> 0..5 Loans)."
            },
            {
              "question": "Draw Sequence Diagram for User Login flow.",
              "answer": "**Actors/Objects:** User, Frontend, AuthService, Database. \n**Flow:** \n1. User -> `login(user, pass)` -> Frontend. \n2. Frontend -> `auth(user, pass)` -> AuthService. \n3. AuthService -> `findUser()` -> Database. \n4. Database --> returns User. \n5. AuthService --> returns Token. \n6. Frontend --> redirects to Home."
            },
            {
              "question": "Difference between Aggregation and Composition?",
              "answer": "**Aggregation:** Weak 'Has-A'. Child can exist independently. (Car and Driver). Destroy Car, Driver lives on. (Empty Diamond). \n**Composition:** Strong 'Has-A'. Child dies with Parent. (House and Room). Destroy House, Room is gone. (Filled Diamond)."
            },
            {
              "question": "When to use Sequence vs Activity diagram?",
              "answer": "**Sequence:** Focus on **Interactions** between objects over time. (Message passing). \n**Activity:** Focus on **Control Flow** / Process workflow (Conditions, Parallel execution). Like a flowchart."
            },
            {
              "question": "How to represent interfaces in Class diagrams?",
              "answer": "1. Using `<<interface>>` stereotype above the class name. \n2. Classes realize (implement) it using a **Dashed line with a Checkered/Hollow Triangle** arrow."
            }
          ]
        },
        {
          "id": "lld_interview_approach",
          "name": "How to Approach LLD Problems",
          "estimatedHours": 2,
          "description": "Learn the systematic approach to LLD interviews - requirement gathering, identifying entities, defining relationships, and writing clean code.",
          "practiceQuestions": [
            {
              "name": "LLD Interview Guide",
              "slug": "lld-interview-guide",
              "difficulty": "Medium",
              "link": "https://github.com/tssovi/grokking-the-object-oriented-design-interview"
            }
          ],
          "learningTip": [
            "**Clarify First:** Don't start coding immediately. Ask about scale, users, and constraints.",
            "**Noun-Verb Analysis:** Identify Nouns -> Classes/Entities. Identify Verbs -> Methods/Relationships.",
            "**Bottom-Up or Top-Down:** core entities first (Bottom-Up) is usually safer for LLD than Top-Down.",
            "**Extensibility:** Always ask 'What if X changes?'. Use interfaces/patterns to handle change."
          ],
          "mustNotMiss": [
            "**Step 1: Requirements:** Functional (Book tickets) & Non-Functional (High concurrency).",
            "**Step 2: Entities:** User, Movie, Theater, Booking, Payment.",
            "**Step 3: Relationships:** Theater *has many* Screens. Screen *has many* Seats.",
            "**Step 4: API Design:** `bookingService.createBooking(user, show, seats)`.",
            "**Step 5: Code:** Write clean, modular code. Handle exceptions."
          ],
          "resources": [
            "https://github.com/donnemartin/system-design-primer",
            "https://www.educative.io/courses/grokking-the-object-oriented-design-interview"
          ],
          "interviewQuestions": [
            {
              "question": "How to gather requirements in first 5 minutes?",
              "answer": "**Ask WHO, WHAT, WHERE:** \n1. **Actors:** Who uses it? (Admin? Customer?). \n2. **Use Cases:** What can they do? (Book? Cancel? Search?). \n3. **Scale:** How much data? (Needs concurrency handling?). \n4. **Constraints:** Offline support? Mobile? \n*Write these down immediately.*"
            },
            {
              "question": "Walk through converting requirements to DB Schema.",
              "answer": "1. **Nouns -> Tables:** 'User books a Movie' -> User, Movie, Booking tables. \n2. **Verbs -> Relationships:** 'User *has* many Bookings'. \n3. **Attributes:** Add fields (ID, Name, Date). \n4. **Normalization:** Remove redundancy (Don't store Movie Name in Booking, store MovieID)."
            },
            {
              "question": "How do you identify which design patterns to use?",
              "answer": "**Keywords:** \n- 'Multiple interchangeable ways': **Strategy**. \n- 'One global instance': **Singleton**. \n- 'Undo/Redo': **Command**. \n- 'Notifying users': **Observer**. \n- 'Complex object construction': **Builder**."
            },
            {
              "question": "How do you handle ambiguous requirements?",
              "answer": "**Ask clarifying questions!** \n\"Should we handle refunds?\" \n\"Is this a global system or single theater?\" \nIf interviewer says \"You decide\", state your assumption: \"I will assume a global system for better scalability.\""
            },
            {
              "question": "What questions should you ask before starting?",
              "answer": "1. Scope: \"Are we building the backend or just the class design?\" \n2. Users: \"Who are the primary actors?\" \n3. Scale: \"Do we need to worry about sharding/concurrency now?\" \n4. Interfaces: \"Should I define the variable types strictly?\""
            }
          ]
        }
      ]
    },
    {
      "id": "tictactoe_case_study",
      "name": "Case Study: TicTacToe",
      "tier": 2,
      "estimatedHours": 6,
      "topics": [
        {
          "id": "design_tictactoe",
          "name": "Design TicTacToe",
          "estimatedHours": 2,
          "description": "Design and implement TicTacToe - understand requirements, design entities, and plan for extensibility like N×N boards and undo functionality.",
          "practiceQuestions": [
            {
              "name": "Valid Sudoku",
              "slug": "valid-sudoku",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/valid-sudoku/"
            },
            {
              "name": "N-Queens",
              "slug": "n-queens",
              "difficulty": "Hard",
              "link": "https://leetcode.com/problems/n-queens/"
            }
          ],
          "learningTip": [
            "**Core Entities:** Game, Board, Player, Cell, Symbol(Enum).",
            "**Scalability:** Design for N*N board from day 1, not just 3x3.",
            "**Extensibility:** Use `Player` abstract class to support Human and Bot strategies.",
            "**Command Pattern:** Essential for implementing 'Undo' feature in games."
          ],
          "mustNotMiss": [
            "**Board Representation:** `Cell[][] grid`. `Cell` has coordinates and symbol.",
            "**Win Detection:** Naive `O(N^2)` is bad. Optimized `O(1)` using row/col counters is Senior level.",
            "**Game Loop:** `while(!gameOver) { input -> move -> checkWin -> switchPlayer }`.",
            "**Separation:** `Game` class controls flow. `Board` class manages state. `Player` class decides moves."
          ],
          "resources": [
            "https://leetcode.com/discuss/interview-question/345744/Google-or-Onsite-or-Design-Tic-Tac-Toe"
          ],
          "interviewQuestions": [
            {
              "question": "Design TicTacToe for N×N board.",
              "answer": "**Scalability:** Don't hardcode 3x3. Use `size` variable in `Board` class. \n**Win Check:** Checking every cell? O(N^2) - Bad. \n**Optimization:** Maintain `rows[N]`, `cols[N]`, `diag`, `antiDiag` counters. Win check becomes **O(1)**."
            },
            {
              "question": "How would you add Undo functionality?",
              "answer": "Use **Command Pattern**. \nEach move is a `MoveCommand` object storing `(row, col, list_player)`. \nPush to `historyStack`. \n`undo()` pops stack, clears cell, and decrements the O(1) win counters."
            },
            {
              "question": "How to check win condition efficiently?",
              "answer": "For Player +1: Increment `row[r]`, `col[c]`. \nFor Player -1: Decrement. \nIf `abs(row[r]) == N`, player wins. \n**Time Complexity:** O(1) per move. \n**Space Complexity:** O(N) for counters."
            },
            {
              "question": "How to make game extensible for multiple players?",
              "answer": "Instead of `+1/-1`, use a `Map<PlayerId, Counters>`. \nOr, generalize the `WinningStrategy` interface. \n`DefaultWinningStrategy` checks rows/cols. \n`CornerWinningStrategy` checks corners. \nInject strategy into Game constructor."
            },
            {
              "question": "How would you add AI opponent?",
              "answer": "Create `BotPlayer extends Player`. \nImplement `makeMove(board)` using **Minimax Algorithm** (for small N) or Heuristics/Random (for large N). \nGame loop doesn't change: `currentPlayer.makeMove()` works for both Human and Bot."
            }
          ]
        },
        {
          "id": "code_tictactoe_1",
          "name": "Code TicTacToe - Part 1",
          "estimatedHours": 2,
          "description": "Implement TicTacToe core - Board and Player classes, game initialization, and the basic game loop.",
          "practiceQuestions": [
            {
              "name": "Find Winner on Tic Tac Toe",
              "slug": "find-winner-on-a-tic-tac-toe-game",
              "difficulty": "Easy",
              "link": "https://leetcode.com/problems/find-winner-on-a-tic-tac-toe-game/"
            }
          ],
          "learningTip": [
            "**Separation of concerns:** Board, Player, Game, and Move should be separate classes. Board handles grid state, Game handles rules and turns.",
            "**Enums for markers:** Use an enum (`X`, `O`, `EMPTY`) instead of strings or chars. Type safety prevents bugs.",
            "**Win checking:** Check rows, columns, and diagonals after each move. Only need to check the row/col/diagonal of the last move — O(n) not O(n²).",
            "**Board representation:** 2D array is simplest. For O(1) win checks, maintain count arrays for each row, column, and both diagonals."
          ],
          "mustNotMiss": [
            "**Board:** Initialize N×N grid of Cells.",
            "**makeMove(row, col, symbol):** Place symbol if valid.",
            "**isValidMove(row, col):** Cell exists and empty.",
            "**Player:** abstract getMove() for different player types.",
            "**Symbol enum:** X, O (and EMPTY for unoccupied)."
          ],
          "resources": [
            "https://www.geeksforgeeks.org/design-a-tic-tac-toe-game/"
          ],
          "interviewQuestions": [
            {
              "question": "Implement the Board and Player classes.",
              "answer": "**Board:** `Cell[][] grid`. Methods: `applyMove()`, `getFreeCells()`. \n**Player:** `abstract makeMove(board)`. \n**HumanPlayer:** Prompts input. \n**BotPlayer:** Calculates move. \n*Key:* Board should encompass the state, Player should encompass the decision."
            },
            {
              "question": "Write logic to check for win condition in O(1) or O(N).",
              "answer": "Keep `rowMatches` and `colMatches` arrays. \nWhen placing 'X' at (i, j): \n`rowMatches[i]++` \n`colMatches[j]++` \nIf `rowMatches[i] == N`, X wins. \n*Note:* Naive loop check is O(N), counter approach is O(1) per move."
            },
            {
              "question": "How do you handle invalid moves?",
              "answer": "1. **Custom Exception:** `InvalidMoveException` (out of bounds, cell occupied). \n2. **Return Boolean:** `makeMove()` returns `false`. \n**Best:** `isValidMove()` check BEFORE attempting move in UI/Game manager."
            },
            {
              "question": "How to design for immutability?",
              "answer": "Make `Board` immutable. `makeMove()` returns a **new** Board instance with the move applied. \n*Pros:* Easy structural sharing, thread-safe, great for AI recursion (Minimax). \n*Cons:* Memory overhead (garbage collection)."
            },
            {
              "question": "How would you serialize game state?",
              "answer": "**JSON/FEN string:** Store board flattened string `\"X.O.X...\"` plus `currentPlayer`. \nOr serialize the **List of Moves** (Event Sourcing). Replaying moves reconstructs state (and supports Replay feature)."
            }
          ]
        },
        {
          "id": "code_tictactoe_2",
          "name": "Code TicTacToe - Part 2",
          "estimatedHours": 2,
          "description": "Complete TicTacToe implementation - game loop, win detection, draw detection, and adding bot player with simple AI.",
          "practiceQuestions": [
            {
              "name": "Sudoku Solver",
              "slug": "sudoku-solver",
              "difficulty": "Hard",
              "link": "https://leetcode.com/problems/sudoku-solver/"
            }
          ],
          "learningTip": [
            "**Strategy pattern for players:** Abstract `Player` class with `makeMove()`. Subclass `HumanPlayer` (input) and `AIPlayer` (minimax algorithm).",
            "**Undo functionality:** Use Command pattern — store each move as a command object. Undo = pop last command and reverse it.",
            "**Extensibility:** Design for NxN board, not just 3x3. Win condition = N in a row. Factory creates the right-sized board.",
            "**Game loop:** `while (!game.isOver()) { currentPlayer.makeMove(board); game.switchTurn(); }` — clean separation of control flow."
          ],
          "mustNotMiss": [
            "**Game Loop:** `while(!gameOver) { player = nextPlayer(); move = player.getMove(); board.makeMove(); checkWin(); }`",
            "**O(1) Win Check:** `rowCounts[N], colCounts[N], diagCount, antiDiagCount`.",
            "**Draw:** Board full and no winner.",
            "**Bot Player:** Extends Player, overrides `getMove()` with AI logic.",
            "**Minimax:** Recursive algorithm for optimal moves."
          ],
          "resources": [
            "https://www.freecodecamp.org/news/minimax-algorithm-guide-how-to-create-an-unbeatable-ai/"
          ],
          "interviewQuestions": [
            {
              "question": "Implement the Game Loop logic.",
              "answer": "```java\nwhile (status == IN_PROGRESS) {\n  Move move = currentPlayer.makeMove(board);\n  board.apply(move);\n  if (wins(currentPlayer)) status = P1_WON;\n  else if (board.full()) status = DRAW;\n  else switchPlayer();\n}\n```"
            },
            {
              "question": "Add support for a Bot player.",
              "answer": "**Polymorphism:** `Player` interface has `decideMove()`. \n`RandomBot` picks random free cell. \n`SmartBot` uses Minimax. \nGame Loop calls `p.decideMove()` blindly, effectively supporting any mix of Humans/Bots."
            },
            {
              "question": "Implement O(1) win detection.",
              "answer": "Maintain `int[] rowCount`, `int[] colCount`, `int diag`, `int antiDiag`. \n+1 for Player A, -1 for Player B. \nAfter move at (r,c): update counts. If any count == N or -N, current player wins."
            },
            {
              "question": "How would you implement Minimax AI?",
              "answer": "Recursive function `minimax(board, depth, isMaximizing)`. \nBase case: Win (+10), Loss (-10), Draw (0). \nRecursive: Try all empty cells, call minimax, pick best score. \n**Optimization:** Alpha-Beta Pruning to skip bad branches."
            },
            {
              "question": "How to add replay functionality?",
              "answer": "**Command Pattern:** Store every `MoveCommand` in a list. \nTo replay: Create new Board, iterate list with delay, calling `execute()` for each move. \nAllows 'Fast Forward' and 'Rewind' if Commands are undoable."
            }
          ]
        }
      ]
    },
    {
      "id": "parking_lot_case_study",
      "name": "Case Study: Parking Lot",
      "tier": 2,
      "estimatedHours": 4,
      "topics": [
        {
          "id": "design_parking_lot",
          "name": "Design Parking Lot",
          "estimatedHours": 2,
          "description": "Design a parking lot system - multiple floors, different vehicle types, various pricing strategies, and handling concurrent spot allocation.",
          "practiceQuestions": [
            {
              "name": "Design Parking System",
              "slug": "design-parking-system",
              "difficulty": "Easy",
              "link": "https://leetcode.com/problems/design-parking-system/"
            }
          ],
          "learningTip": [
            "**Core Entities:** ParkingLot, Floor, Spot, Vehicle, Ticket, Payment.",
            "**Spot Allocation:** Strategy Pattern (Nearest vs Random). Min-Heap is best for 'Nearest'.",
            "**Pricing Engine:** Strategy Pattern (Hourly, Member, Weekend). Decorator for 'EV Charging' add-on.",
            "**Concurrency:** Optimistic Locking is usually sufficient for single-lot systems. Redis Lock for distributed."
          ],
          "mustNotMiss": [
            "**Entities:** ParkingLot(singleton?), Floor, Spot(type, status), Vehicle(type), Ticket(entryTime).",
            "**Spot Types:** Compact(Bike), Large(Truck), Electric(EV charging).",
            "**Pricing:** Strategy Interface `calculate(ticket)`. Easy to swap formulas.",
            "**Factory:** `VehicleFactory.create(type)` to abstract vehicle creation.",
            "**Concurrency:** Two drivers spot the same free space. Handle via DB Lock or Synchronized."
          ],
          "resources": [
            "https://www.educative.io/blog/grokking-parking-lot-design",
            "https://github.com/tssovi/grokking-the-object-oriented-design-interview"
          ],
          "interviewQuestions": [
            {
              "question": "Design Parking Lot with multiple vehicle types and pricing.",
              "answer": "**Classes:** `ParkingLot`, `Floor`, `Spot` (Compact, Large). \n**Pricing:** `PricingStrategy` interface. \n`HourlyStrategy`, `WeekendStrategy`. \nCalculate cost on exit using Ticket timestamp."
            },
            {
              "question": "Handle concurrency: Two users booking same spot.",
              "answer": "**Optimistic Locking:** Recommended. DB versioning. \n**Distributed Lock (Redis/Redlock):** Essential for microservices. 'Synchronized block' only works for single-instance monoliths. \n**DB Row Lock:** `SELECT ... FOR UPDATE` ensures strong consistency."
            },
            {
              "question": "How to find nearest available spot to entrance?",
              "answer": "1. **Min-Heap:** Maintain a Min-Heap of free spots ordered by distance/ID. O(1) to get nearest, O(log N) to updates. \n2. **TreeSet:** Keep free spots in sorted set (Floor 1 < Floor 2). \n*Do NOT scan all spots linearly.*"
            },
            {
              "question": "How to add support for EV charging spots?",
              "answer": "Add `SpotType.ELECTRIC`. \nExtend `Vehicle` to `ElectricVehicle`. \nIn `ParkingStrategy`, prioritize assigning EV spots to EVs. \nAdd `ChargingCost` to the final fee calculation (`ElectricityCost + ParkingCost`)."
            },
            {
              "question": "How to handle monthly subscription parking?",
              "answer": "Introduce `Membership` entity. \nCheck `vehicle.hasMembership()` on entry. \nSkip payment calculation on exit. \nOr use `SubscriptionPricingStrategy` which returns $0 for valid members."
            }
          ]
        },
        {
          "id": "code_parking_lot",
          "name": "Code Parking Lot",
          "estimatedHours": 2,
          "description": "Implement parking lot - spot allocation strategies, payment calculation, and handling concurrent access.",
          "practiceQuestions": [
            {
              "name": "Parking System Implementation",
              "slug": "parking-system-impl",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/design-parking-system/"
            }
          ],
          "learningTip": [
            "**Search Index:** `Map<SpotType, PriorityQueue<Spot>>`. O(1) retrieval of best spot.",
            "**Ticket Calculation:** `(ExitTime - EntryTime) * Rate`. Handle 'Lost Ticket' with max fee.",
            "**Gate Management:** `EntryGate` issues ticket. `ExitGate` processes payment.",
            "**Admin API:** `updateRates()`, `addFloor()`, `disableSpot()`."
          ],
          "mustNotMiss": [
            "**Slot Assignment:** `findNearest()` using Min-Heap is the key algorithm here.",
            "**Payment Flow:** `PaymentService.process(ticket, amount, strategy)`.",
            "**Monitoring:** Dashboard needs real-time count of free spots. Decrement atomic counters on entry.",
            "**Extension:** Multi-level parking, Valet parking (Driver entity)."
          ],
          "resources": [
            "https://leetcode.com/problems/design-parking-system/"
          ],
          "interviewQuestions": [
            {
              "question": "Implement Spot Allocation strategy (nearest to entrance).",
              "answer": "Use a **Min-Heap (PriorityQueue)** of available spots. \n\nComparator: `(Floor, Distance)`. \n\n**O(log N)** to find/park. \n**O(log N)** to free spot (add back to heap). \n*Much better than O(N) linear scan.*"
            },
            {
              "question": "Implement Payment calculation logic (Strategy Pattern).",
              "answer": "Interface `PricingStrategy { double calculate(Ticket t); }` \n\n`HourlyStrategy`: `$4 for 1st hour, $2 after`. \n`DynamicStrategy`: Higher rates if occupancy > 90%. \n`StrategyContext` selects strategy based on VehicleType/Day."
            },
            {
              "question": "How to handle race condition in spot booking?",
              "answer": "Problem: Two threads call `bookSpot(101)` same time. \n**Solution:** \n1. **Synchronized:** `synchronized bookSpot()` (Single instance). \n2. **DB Lock:** `SELECT ... FOR UPDATE` (Pessimistic). \n3. **Optimistic:** `UPDATE spots SET booked=true WHERE id=101 AND booked=false`."
            },
            {
              "question": "How to implement time-based pricing (peak hours)?",
              "answer": "Use a **Rule Engine**. \n\nRules: \n- `DayRule`: Weekday vs Weekend. \n- `TimeRule`: 8am-10am (Peak). \n- `ClientRule`: Corporate vs Guest. \nChain rules to calculate final multiplier."
            },
            {
              "question": "Design the database schema for parking lot.",
              "answer": "**Tables:** \n- `ParkingLot` (id, geo_location) \n- `Floor` (id, level, lot_id) \n- `Spot` (id, floor_id, type_enum, status_enum) \n- `Ticket` (id, vehicle_number, entry_time, spot_id) \n- `Payment` (id, ticket_id, amount, status, txn_id)"
            }
          ]
        }
      ]
    },
    {
      "id": "bookmyshow_case_study",
      "name": "Case Study: BookMyShow",
      "tier": 2,
      "estimatedHours": 6,
      "topics": [
        {
          "id": "design_bookmyshow",
          "name": "Design BookMyShow",
          "estimatedHours": 2,
          "description": "Design a movie ticket booking system - movies, theaters, shows, seat selection, and booking with payment integration.",
          "practiceQuestions": [
            {
              "name": "Design Movie Ticket Booking",
              "slug": "design-movie-ticket",
              "difficulty": "Hard",
              "link": "https://github.com/tssovi/grokking-the-object-oriented-design-interview"
            }
          ],
          "learningTip": [
            "**Core Entities:** Movie, Cinema, Hall, Show(Time), Seat, Booking.",
            "**Complexities:** Concurrency (Locking), Search (Filter by City/Date), Caching.",
            "**Booking State:** Created -> Locked -> Paid -> Booked. (Handle 10-min timeout).",
            "**Seat Map:** Bitmap or JSON blob. Needs efficient rendering data."
          ],
          "mustNotMiss": [
            "**Hierarchy:** City -> Cinema -> Hall -> Show -> ShowSeat.",
            "**ShowSeat:** Decouples physical 'Seat' (static) from 'Show' (dynamic availability).",
            "**Locking:** Redis Distributed Lock with TTL (10 mins) is the industry standard.",
            "**Search:** Indexing on City + Date + Movie is critical for performance.",
            "**Notifications:** Async event bus (Kafka) after successful payment."
          ],
          "resources": [
            "https://medium.com/@narengowda/system-design-for-bookmyshow-9d4b455d3f2",
            "https://www.geeksforgeeks.org/design-movie-ticket-booking-system-like-bookmyshow/"
          ],
          "interviewQuestions": [
            {
              "question": "Design schema for Movies, Theaters, Screens, Shows.",
              "answer": "**Movies:** (id, title, genre). \n**Theaters:** (id, city, name). \n**Screens:** (id, theater_id, name). \n**Shows:** (id, movie_id, screen_id, start_time, end_time). \n**ShowSeats:** (id, show_id, seat_number, status, price, booking_id). *Crucial for tracking per-show availability.*"
            },
            {
              "question": "How to handle seat locking during booking process?",
              "answer": "**Temp Lock:** Set `status = LOCKED` and `lock_expiry = now() + 10min`. \nIf user doesn't pay in 10 mins, background job frees the seat. \nPrevents others from selecting it while user pays."
            },
            {
              "question": "How to prevent double booking of same seat?",
              "answer": "**Database Transaction:** \n`SELECT ... FOR UPDATE` (Pessimistic) or \n`UPDATE show_seats SET status='LOCKED' WHERE id=? AND status='AVAILABLE'` (Optimistic). \nEnsure ACID properties on the booking transaction."
            },
            {
              "question": "How to handle payment timeout?",
              "answer": "1. Client sends 'Payment Failed/Cancelled'. \n2. **Cron Job / Delay Queue:** Checks for 'LOCKED' seats with `expiry < now()`. \n3. Updates status back to 'AVAILABLE'."
            },
            {
              "question": "How to implement seat map visualization?",
              "answer": "Client needs `SeatLayout` (Row/Col coords) + `AvailabilityStatus`. \nUse a bitmap or sparse matrix if highly dense. \nTypically: Send list of ALL seats with status. Client renders grid."
            }
          ]
        },
        {
          "id": "code_bookmyshow_1",
          "name": "Code BookMyShow - Part 1",
          "estimatedHours": 2,
          "description": "Implement BookMyShow core - search interface, browsing movies and shows, and class structure for booking flow.",
          "practiceQuestions": [
            {
              "name": "Number of Distinct Islands",
              "slug": "number-of-distinct-islands",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/max-area-of-island/"
            }
          ],
          "learningTip": [
            "**Service Layer:** MovieService (Catalog), ShowService (Availability), BookingService (Transaction).",
            "**Booking Workflow:** `selectSeats` -> `lockSeats` -> `initiatePayment` -> `confirmBooking`.",
            "**Search Optimization:** Caching 'Now Showing' movies in Redis per city.",
            "**Seat Map API:** Returns all seats with status (Available/Booked/Locked)."
          ],
          "mustNotMiss": [
            "**Controller:** `BookingController.create(payload)`. Validates input.",
            "**Service:** `lockSeats()` must be atomic/transactional.",
            "**Repository:** `ShowSeatRepository.findAvailable(showId)`.",
            "**Factory:** `PaymentFactory` to switch between PayPal/Stripe."
          ],
          "resources": [
            "https://leetcode.com/discuss/interview-question/system-design/"
          ],
          "interviewQuestions": [
            {
              "question": "Implement Search interface (by City, Movie, Date).",
              "answer": "**Elasticsearch** is best for full-text search. \nFor SQL: `SELECT * FROM shows WHERE city_id=? AND date=?`. \n**Cache:** Cache heavily accessed data (Movies in City X) in Redis, as showtimes don't change often."
            },
            {
              "question": "Create class structure for Booking and Payments.",
              "answer": "**Booking:** `List<ShowSeat> seats`, `User`, `Show`, `BookingStatus` (Created, PendingPayment, Confirmed). \n**Payment:** `BookingID`, `Amount`, `PaymentMode`, `TransactionStatus`. \nBooking HAS-A Payment."
            },
            {
              "question": "How to efficiently query available shows?",
              "answer": "**Read-Heavy Path:** Browsing shows/seats is 99% reads. \n**Caching (Redis):** Cache seat map per show. Invalidate cache on booking. \n**DB:** Index on `(city_id, movie_id, date)` covers most queries. \n**Sharding:** Shard by `City` if scale is massive."
            },
            {
              "question": "How to implement filtering and sorting?",
              "answer": "**Filter:** SQL `WHERE` clauses (Genre, Language). \n**Sort:** `ORDER BY start_time ASC`. \n**Frontend:** Can filter results in-memory if result set is small (e.g., specific theater shows)."
            },
            {
              "question": "Design the API contracts.",
              "answer": "`GET /cinemas?city=nyc` \n`GET /shows?cinema=123&date=2023-10-01` \n`GET /shows/{showId}/seats` \n`POST /bookings { showId, seatIds[] }` -> Returns `bookingId` (Locked). \n`POST /payments { bookingId, token }` -> Confirms booking."
            }
          ]
        },
        {
          "id": "code_bookmyshow_2",
          "name": "Code BookMyShow - Part 2",
          "estimatedHours": 2,
          "description": "Complete BookMyShow - concurrent seat locking, payment integration, error handling, and release on timeout/failure.",
          "practiceQuestions": [
            {
              "name": "Design Underground System",
              "slug": "design-underground-system",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/design-underground-system/"
            }
          ],
          "learningTip": [
            "**Distributed Locking:** Redis `SET resource_name my_random_value NX PX 30000`.",
            "**State Machine:** Booking transitions must be strictly enforced.",
            "**Payment Integration:** Webhooks from Stripe/PayPal to update status.",
            "**Cleanup:** Scheduler (Cron) to release expired locks (`PENDING > 10m`)."
          ],
          "mustNotMiss": [
            "**Double Booking:** Prevent via database constraints or distributed locks.",
            "**Idempotency:** Payment webhook might fire twice. Handle gracefully.",
            "**Isolation:** `SERIALIZABLE` isolation level for booking transaction could be too slow. Use row locks.",
            "**Failures:** If payment fails, release lock immediately for others."
          ],
          "resources": [
            "https://redis.io/docs/manual/patterns/distributed-locks/"
          ],
          "interviewQuestions": [
            {
              "question": "Implement concurrency lock for seat selection.",
              "answer": "Use **Redis Distributed Lock** (Redlock). \n\nKey: `lock:show:{showId}:seat:{seatId}`. TTL: 10 mins. \n\nIf User A acquires lock, User B gets 'Seat Unavailable'. \n*Releasing:* On payment success OR TTL expiry."
            },
            {
              "question": "Handle payment failures and seat release.",
              "answer": "Use **State Pattern** for Booking. \n`CREATED` -> `LOCKED` -> `PAID` / `FAILED`. \n\n**Scheduler:** Runs every minute. Finds `LOCKED` bookings created > 10 mins ago. \n- Updates status to `EXPIRED`. \n- Releases Redis/DB lock."
            },
            {
              "question": "How to implement optimistic vs pessimistic locking?",
              "answer": "**Optimistic (Version):** `UPDATE seats SET status='L' WHERE id=1 AND version=v`. Fast, no DB lock. Good for low contention. \n**Pessimistic (Select for Update):** `SELECT * ... FOR UPDATE`. Locks row. Good for high contention (Avengers Opening), but reduces throughput."
            },
            {
              "question": "How to handle partial payment failures?",
              "answer": "Scenario: User books 4 seats, payment gateway charges for 2. \n**Solution:** Atomic Transaction. \nEither ALL charged or NONE. \nIf ambiguous state: Auto-refund the partial amount and cancel booking."
            },
            {
              "question": "Design the notification system for booking confirmation.",
              "answer": "**Async Event Bus.** \n\n1. `PaymentService` emits `BookingConfirmedEvent`. \n2. `NotificationService` listens (Kafka consumer). \n3. Sends Email/SMS/WhatsApp. \n*Decouples fast booking flow from slow email API.*"
            }
          ]
        }
      ]
    },
    {
      "id": "splitwise_case_study",
      "name": "Case Study: Splitwise",
      "tier": 2,
      "estimatedHours": 6,
      "topics": [
        {
          "id": "design_splitwise",
          "name": "Design Splitwise",
          "estimatedHours": 2,
          "description": "Design Splitwise expense sharing app - users, groups, expenses, different split types, and debt simplification algorithm.",
          "practiceQuestions": [
            {
              "name": "Minimum Path Sum",
              "slug": "minimum-path-sum",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/minimum-path-sum/"
            }
          ],
          "learningTip": [
            "**Core Entities:** User, Group, Expense, Split(Type), Balance.",
            "**Split Logic:** Factory Pattern to handle Equal/Exact/Percent splits.",
            "**Debt Graph:** Directed graph where Edge(A, B) = Amount A owes B.",
            "**Key Algorithm:** Debt Simplification (Minimize cash flow) using Greedy algo."
          ],
          "mustNotMiss": [
            "**Expense:** `type` (EQUAL, EXACT), `payer`, `splits` list.",
            "**Validation:** Sum of splits must equal total amount. Percentages must sum to 100%.",
            "**Balance Sheet:** `Map<User, Double>`. +ve means you are owed, -ve means you owe.",
            "**Simplification:** `Debtors` (-ve) and `Creditors` (+ve) lists. Match max to max."
          ],
          "resources": [
            "https://leetcode.com/problems/optimal-account-balancing/",
            "https://medium.com/@swayamraina/redesigning-splitwise-a-system-design-perspective-1c888169134"
          ],
          "interviewQuestions": [
            {
              "question": "Design algorithm to simplify debts (minimize transactions).",
              "answer": "**Greedy Approach (Standard):** \n1. Calculate Net Balance for each user. \n2. Separate into `Debtors` (Negative) and `Creditors` (Positive). \n3. Sort both by magnitude. \n4. Match Max Debtor with Max Creditor. Settle min(abs(debt), credit). \n5. Repeat O(N) times. \n*Note: Gets close to optimal (N-1 transactions) but is not strictly optimal (NP-Hard).* "
            },
            {
              "question": "Design schema for Users, Groups, Expenses.",
              "answer": "**Users:** `(id, name, email)` \n**Expenses:** `(id, group_id, payer_id, amount, currency, created_at)` \n**ExpenseSplits:** `(expense_id, user_id, amount_owed)` \n**Settlements:** `(id, payer_id, payee_id, amount)` \n**GroupBalances:** `(group_id, user1_id, user2_id, net_amount)` *Snapshot for fast read.*"
            },
            {
              "question": "How to handle multi-currency expenses?",
              "answer": "**Independent Graphs:** \nMaintain separate debt graphs for USD, EUR, INR. \nUser A owes User B $10. \nUser B owes User A €5. \n*Do not auto-convert* unless users trigger 'Settle Up' with a specific FX rate."
            },
            {
              "question": "How to split an expense by percentage?",
              "answer": "**Validation & Rounding:** \n1. Check `sum(percentages) == 100%`. \n2. `share = total * (percent/100)`. \n3. **Penny Problem:** If total is $100.00 split 3 ways (33.333...), shares are 33.33, 33.33, 33.34. The last penny goes to the payer or random user."
            },
            {
              "question": "How to handle expense modifications/deletes?",
              "answer": "**Immutable/Reversal Logic:** \nDon't update in place. \n1. Create a **Reverse Expense** (Negative amount) to nullify the old one. \n2. Create a **New Expense** with correct data. \n3. Re-run simplification on the new set of transactions."
            }
          ]
        },
        {
          "id": "code_splitwise_1",
          "name": "Code Splitwise - Part 1",
          "estimatedHours": 2,
          "description": "Implement Splitwise core - Expense class with different split types and user balance tracking.",
          "practiceQuestions": [
            {
              "name": "Split Array Into Consecutive Subsequences",
              "slug": "split-array-into-consecutive-subsequences",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/split-array-into-consecutive-subsequences/"
            }
          ],
          "learningTip": [
            "**Expense Factory:** `ExpenseFactory.createExpense(type, amount, splits, metadata)`.",
            "**Round Robin Rounding:** Handle 'Penny Problem' ($100/3 = 33.33, 33.33, 33.34).",
            "**Strategy Pattern:** `SplitStrategy.validate()` ensures math is correct.",
            "**Observer Pattern:** Notify users when added to an expense."
          ],
          "mustNotMiss": [
            "**EqualSplit:** `amount = total / n`. Handle remainder.",
            "**ExactSplit:** `sum(splits) == total`.",
            "**PercentSplit:** `sum(percentages) == 100%`.",
            "**Concurrency:** Updating `BalanceSheet` needs transactional integrity (DB or Lock).",
            "**Immutability:** Expenses are usually immutable history. 'Edit' creates a reversal + new expense."
          ],
          "resources": [
            "https://refactoring.guru/design-patterns/factory-method"
          ],
          "interviewQuestions": [
            {
              "question": "Implement Expense class with Equal, Exact, Percent splits.",
              "answer": "**Factory Pattern:** `ExpenseFactory.create(Type, args)`. \n**Strategy Pattern:** `SplitStrategy.validate()`. \n`EqualSplit` computes `total/N`. \n`ExactSplit` checks `sum(shares) == total`. \nInheritance: `Expense` -> `EqualExpense`, `ExactExpense`."
            },
            {
              "question": "Implement UserBalance sheet logic.",
              "answer": "Maintain `Map<User, Double> balanceSheet`. \nFor an expense of $100 paid by A, shared by A, B, C, D ($25 each): \nA gets +75. \nB, C, D get -25. \nUpdate global running balance."
            },
            {
              "question": "How to handle rounding in equal splits?",
              "answer": "$100 / 3 people = 33.333... \nSplit: 33.33, 33.33, 33.34. \n**Algorithm:** Give base amount `floor(total/n)` to all. \nGive remainder `0.01` to the first `k` people (`total % n`). \nEnsures `sum == total`."
            },
            {
              "question": "How to validate expense before saving?",
              "answer": "1. Check if all participants exist. \n2. Check `sum(splits) == totalAmount` (Prevent money creation/deletion). \n3. Check inputs (non-negative). \nThrows `ValidationException`."
            },
            {
              "question": "Design the data model for balance tracking.",
              "answer": "Usually computed on fly from Expenses? No, slow. \n**Snapshot Model:** Store `GroupBalance { user_id, amount }`. \nUpdate asynchronously or transactionally when Expense is added."
            }
          ]
        },
        {
          "id": "code_splitwise_2",
          "name": "Code Splitwise - Part 2",
          "estimatedHours": 2,
          "description": "Complete Splitwise - debt simplification algorithm using graph-based approach and optional multi-currency support.",
          "practiceQuestions": [
            {
              "name": "Evaluate Division",
              "slug": "evaluate-division",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/evaluate-division/"
            }
          ],
          "learningTip": [
            "**Debt simplification:** After all expenses, compute net balances. A person with +500 owes nothing; a person with -300 owes 300. Match positives with negatives.",
            "**Graph-based approach:** Model debts as a directed graph. Simplify by computing net flow. Use greedy matching (largest creditor ↔ largest debtor).",
            "**Split strategies:** Equal, exact amounts, percentage-based. Use Strategy pattern — `SplitStrategy` interface with `calculateShares()` method.",
            "**Concurrency concern:** Multiple users adding expenses simultaneously. Use optimistic locking on group balance or event sourcing for conflict resolution."
          ],
          "mustNotMiss": [
            "**Calculate net per user:** `netBalance[user] = received - paid`.",
            "**Split:** into creditors (positive) and debtors (negative).",
            "**Greedy Algorithm:** Sort both lists. Match head of each.",
            "**Transaction:** `min(creditor amount, debtor amount)`. Update both.",
            "**Result:** List of `(from, to, amount)` transactions."
          ],
          "resources": [
            "https://medium.com/@mithunmk93/algorithm-to-settle-debts-simplify-debt-graph-34fd572e92c2"
          ],
          "interviewQuestions": [
            {
              "question": "Code the Debt Simplification algorithm.",
              "answer": "Use a Heap-based Greedy implementation. \nMaxHeap `givers`, MaxHeap `receivers`. \nPop maxGiver ($100), maxReceiver ($50). \nTransact $50. Giver still owes $50, push back. \nRepeat until heaps empty."
            },
            {
              "question": "Handle multi-currency expenses.",
              "answer": "Complex simplification involves exchange rates. \n**Simpler:** Maintain separate simplistic graphs per currency. \nUser A owes User B 10 USD. \nUser B owes User A 5 EUR. \nDon't mix them unless user explicitly requests currency conversion settlement."
            },
            {
              "question": "How to prove minimality of transactions?",
              "answer": "The greedy algorithm does *not* strictly guarantee minimum *number* of transactions (NP-Complete Subset Sum problem). \nBut it guarantees N-1 transactions, which is efficient enough for real-world (approximate solution)."
            },
            {
              "question": "How to handle settle-up notifications?",
              "answer": "Settle-up is just an Expense where `Payer` pays `Receiver` and split is 100% to Payer. \nTriggers O/S Native Push Notification (FCM/APNS) to the receiver: \"A paid you $50\"."
            },
            {
              "question": "Design the activity feed for expense updates.",
              "answer": "Event-Driven. \nExpense Added -> `ActivityEvent` -> Persist to `ActivityLog` table. \nFeed API: `SELECT * FROM ActivityLog WHERE group_id IN (user_groups) ORDER BY time DESC`."
            }
          ]
        }
      ]
    },
    {
      "id": "calendar_case_study",
      "name": "Case Study: Google Calendar",
      "tier": 2,
      "estimatedHours": 2,
      "topics": [
        {
          "id": "design_google_calendar",
          "name": "Design Google Calendar",
          "estimatedHours": 2,
          "description": "Design a calendar system - events, recurring events, finding free slots, and invitations with RSVP.",
          "practiceQuestions": [
            {
              "name": "My Calendar I",
              "slug": "my-calendar-i",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/my-calendar-i/"
            },
            {
              "name": "My Calendar II",
              "slug": "my-calendar-ii",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/my-calendar-ii/"
            },
            {
              "name": "Interval List Intersections",
              "slug": "interval-list-intersections",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/interval-list-intersections/"
            },
            {
              "name": "Merge Intervals",
              "slug": "merge-intervals",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/merge-intervals/"
            }
          ],
          "learningTip": [
            "**Event Structure:** Start, End, Recurrence Rule (RRULE), Attendees.",
            "**Recurrence:** Don't store infinite rows. Store `RRULE` string (RFC 5545).",
            "**Free Slots:** Merge Intervals algorithm (Busy Time) -> Invert -> Free Time.",
            "**Conflict:** efficient overlap check using Segment Tree or Interval Tree."
          ],
          "mustNotMiss": [
            "**RRULE:** `FREQ=WEEKLY;BYDAY=MO,WE`. Expand on read.",
            "**Storage Optim:** Store exceptions to the rule separately (e.g. Cancelled instance).",
            "**Timezones:** Always store UTC. Convert to local time on UI.",
            "**Availability:** `Intersect(UserA.Free, UserB.Free)`."
          ],
          "resources": [
            "https://leetcode.com/discuss/interview-question/object-oriented-design/1582235/Design-Google-Calendar",
            "https://icalendar.org/RFC-Specifications/iCalendar-RFC-5545/"
          ],
          "interviewQuestions": [
            {
              "question": "Design system to find common free slot for 5 users.",
              "answer": "**Merge Intervals Algorithm:** \n1. Retrieve sorted busy intervals for all users. `[9-10], [9:30-11], [13-14]`. \n2. **Merge:** `[9-11], [13-14]`. \n3. **Invert:** Gaps are free slots: `[11-13], [14-17]`. \n4. Intersect with 'Working Hours' (9am-5pm)."
            },
            {
              "question": "How to handle recurring events in database?",
              "answer": "**RRULE Standard (RFC 5545):** \nStore `RRULE:FREQ=WEEKLY;BYDAY=MO,FR;UNTIL=20251231`. \n**Exceptions Table:** Stores moved/deleted instances. `(event_id, original_start, new_start, status)`. \n*Read:* Generate instances from RRULE, then apply Overrides from Exceptions table."
            },
            {
              "question": "How to detect conflicts efficiently?",
              "answer": "**Augmented Interval Tree:** \nTree nodes store `(start, end, max_end_in_subtree)`. \nQuery: Does any interval overlap with `[reqStart, reqEnd]`? \n**O(log N)** complexity. \nDatabase: Spatial Indexes (R-Tree) or PostgreSQL `tsrange` with `&&` operator."
            },
            {
              "question": "How to implement reminders?",
              "answer": "**Distributed Scheduler:** \n1. **Time-Partitioning:** Shard IDs by `minute_bucket`. \n2. **Poller:** Each minute, fetch events where `remind_at = now()`. \n3. **Push:** Send to Notification Queue (Kafka). \n4. **Idempotency:** Ensure duplicates don't send double alerts."
            },
            {
              "question": "How to handle timezone differences?",
              "answer": "**Golden Rule: Store UTC.** \nUser sees events in their *Display Timezone*. \n**Challenge:** '9am Daily' recurring event. \nIf DST shifts, does it stay 9am (wall clock) or shift to 10am (absolute)? \n*RRULEs are typically loose (Wall Clock time) linked to a specific Timezone ID.*"
            }
          ]
        }
      ]
    },
    {
      "id": "concurrency_threading",
      "name": "Concurrency & Multithreading",
      "tier": 3,
      "estimatedHours": 4,
      "topics": [
        {
          "id": "concurrency_fundamentals",
          "name": "Concurrency & Multithreading Fundamentals",
          "estimatedHours": 2,
          "description": "Master concurrency fundamentals - threads vs processes, synchronization, race conditions, and thread safety patterns.",
          "practiceQuestions": [
            {
              "name": "Print in Order",
              "slug": "print-in-order",
              "difficulty": "Easy",
              "link": "https://leetcode.com/problems/print-in-order/"
            },
            {
              "name": "Print FooBar Alternately",
              "slug": "print-foobar-alternately",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/print-foobar-alternately/"
            },
            {
              "name": "Building H2O",
              "slug": "building-h2o",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/building-h2o/"
            }
          ],
          "learningTip": [
            "**Thread vs Process:** Threads share memory (faster communication, harder synchronization). Processes have separate memory (safer, more overhead).",
            "**Mutex vs Semaphore:** Mutex = binary lock, only one thread at a time. Semaphore = counting lock, allows N threads. Mutex has ownership; Semaphore doesn't.",
            "**Deadlock conditions:** Mutual exclusion + Hold & wait + No preemption + Circular wait. Remove ANY one to prevent deadlock.",
            "**Producer-Consumer pattern:** Shared buffer with `produce()` and `consume()`. Use BlockingQueue or condition variables. Classic interview problem."
          ],
          "mustNotMiss": [
            "**Process vs Thread:** Process = isolated. Thread = shared memory, lightweight.",
            "**Race Condition:** Read-modify-write without synchronization.",
            "**synchronized keyword:** Acquire lock before entering block.",
            "**volatile:** Ensures visibility across threads. Not atomicity.",
            "**Thread Safety:** Immutability, Synchronization, Thread-local, Atomic classes."
          ],
          "resources": [
            "https://docs.oracle.com/javase/tutorial/essential/concurrency/"
          ],
          "interviewQuestions": [
            {
              "question": "Difference between Process and Thread?",
              "answer": "**Process:** Independent execution environment. Has its own memory space (Heap, Stack). Database, Browser. \n**Thread:** Lightweight process. Shares memory (Heap) with other threads in same process. \n*Context switch:* Thread switch is faster than Process switch."
            },
            {
              "question": "What is a Race Condition and how to prevent it?",
              "answer": "**Def:** Two threads access shared data concurrently, and at least one writes, leading to unpredictable results. \n**Prevent:** \n1. **Synchronization:** Locks/Monitors. \n2. **Atomic Variables:** `AtomicInteger`. \n3. **Immutability:** Don't share mutable state."
            },
            {
              "question": "What is the purpose of volatile keyword?",
              "answer": "Guarantees **Visibility** (not Atomicity). \nEnsures that value written to a variable by one thread is immediately visible to other threads (bypassing CPU cache). \n*Use case:* Status flags (`running = false`)."
            },
            {
              "question": "Difference between synchronized and Lock?",
              "answer": "**synchronized:** Implicit monitor lock. Automatic release on exception/exit. Less flexible. \n**Lock (ReentrantLock):** Explicit. Must `unlock()` in `finally` block. Supports `tryLock()` (non-blocking attempt) and multiple conditions."
            },
            {
              "question": "What is thread-safe code?",
              "answer": "Code that functions correctly during simultaneous execution by multiple threads. \nAchieved by: \n1. No shared state (Stateless). \n2. Immutable state. \n3. Synchronized access to mutable state."
            }
          ]
        },
        {
          "id": "advanced_concurrency",
          "name": "Advanced Concurrency - Thread Pool, Producer-Consumer",
          "estimatedHours": 2,
          "description": "Advanced concurrency patterns - thread pools, producer-consumer, wait/notify, semaphores, and deadlock prevention.",
          "practiceQuestions": [
            {
              "name": "Design HashMap",
              "slug": "design-hashmap",
              "difficulty": "Easy",
              "link": "https://leetcode.com/problems/design-hashmap/"
            },
            {
              "name": "Web Crawler Multithreaded",
              "slug": "web-crawler-multithreaded",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/fizz-buzz-multithreaded/"
            },
            {
              "name": "LRU Cache",
              "slug": "lru-cache",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/lru-cache/"
            }
          ],
          "learningTip": [
            "**Thread Pool:** Reuses threads to save creation overhead. (Fixed vs Cached).",
            "**Producer-Consumer:** Decouples work submission from processing using a Queue.",
            "**Semaphores:** Controls access to limited resources (Rate Limiting).",
            "**Deadlock:** Circular dependency. Avoid by acquiring locks in consistent order."
          ],
          "mustNotMiss": [
            "**ExecutorService:** The modern way to handle threads in Java (`submit()`).",
            "**BlockingQueue:** The glue for Producer-Consumer. Handles wait/notify internally.",
            "**Wait-Notify:** Low-level manual synchronization. Hard to get right (spurious wakeups).",
            "**Deadlock Prevention:** 'Hold and Wait', 'Circular Wait'. Break the circle."
          ],
          "resources": [
            "https://www.baeldung.com/java-concurrency",
            "https://docs.oracle.com/javase/tutorial/essential/concurrency/"
          ],
          "interviewQuestions": [
            {
              "question": "How do you implement a Thread Pool?",
              "answer": "1. **Task Queue:** BlockingQueue to hold Runnables. \n2. **Worker Threads:** N threads running `while(true) { task = queue.take(); task.run(); }`. \n*Benefits:* Bounded resources, reuse threads, graceful degradation under load."
            },
            {
              "question": "Solve Producer-Consumer using Semaphores/Wait-Notify.",
              "answer": "**Wait/Notify:** \nProducer: `synchronized(q) { while(full) q.wait(); q.add(); q.notifyAll(); }` \nConsumer: `synchronized(q) { while(empty) q.wait(); q.remove(); q.notifyAll(); }`"
            },
            {
              "question": "What is Deadlock and how to prevent it?",
              "answer": "**Def:** Thread A holds Lock 1, waits for Lock 2. Thread B holds Lock 2, waits for Lock 1. \n**Prevent:** \n1. **Lock Ordering:** Always acquire Lock 1 BEFORE Lock 2. \n2. **tryLock:** Timeout if lock unavailable."
            },
            {
              "question": "How does BlockingQueue work internally?",
              "answer": "Uses `ReentrantLock` and `Condition` variables (`notEmpty`, `notFull`). \n`put()` calls `notFull.await()` if count == limit. \n`take()` calls `notEmpty.await()` if count == 0."
            },
            {
              "question": "Implement a rate limiter using semaphores.",
              "answer": "Initialize `Semaphore(N)` permits. \nRequest comes -> `sem.tryAcquire()`. \nIf true: Process. \nIf false: Reject (429 Too Many Requests). \nRefill permits manually or using a scheduler (Token Bucket)."
            }
          ]
        }
      ]
    },
    {
      "id": "additional_patterns",
      "name": "Additional Design Patterns",
      "tier": 3,
      "estimatedHours": 4,
      "topics": [
        {
          "id": "command_pattern",
          "name": "Command Pattern & Text Editor with Undo",
          "estimatedHours": 2,
          "description": "Master the Command pattern - encapsulating requests as objects for undo/redo, queuing, and logging operations.",
          "practiceQuestions": [
            {
              "name": "Implement Stack using Queues",
              "slug": "implement-stack-using-queues",
              "difficulty": "Easy",
              "link": "https://leetcode.com/problems/implement-stack-using-queues/"
            }
          ],
          "learningTip": [
            "**Command Pattern:** Encapsulates a request as an object, allowing parameterization and queuing.",
            "**Undo/Redo:** The primary use case. Store executed commands in a stack.",
            "**Decoupling:** Sender (Invoker) doesn't know Receiver's details, just calls `execute()`.",
            "**Macro Command:** A command that executes a list of other commands (Batch processing)."
          ],
          "mustNotMiss": [
            "**Interface:** `void execute()`, `void undo()`.",
            "**Invoker:** The button/menu item. Holds the command. Calls `execute()`.",
            "**Receiver:** The logic (e.g., Document). The command calls `receiver.action()`.",
            "**History:** `Stack<Command>`. Undo = `stack.pop().undo()`.",
            "**Redo:** Separate stack. Cleared when new command is executed."
          ],
          "resources": [
            "https://refactoring.guru/design-patterns/command",
            "https://www.geeksforgeeks.org/command-pattern/"
          ],
          "interviewQuestions": [
            {
              "question": "Design Text Editor with Undo/Redo using Command pattern.",
              "answer": "`InsertCommand` stores text + position. \n`execute()`: Inserts text. \n`undo()`: Deletes text at position. \n`Editor` maintains `Stack<Command>`. \nTyped 'A', 'B'. Stack: [`Cmd(A)`, `Cmd(B)`]. \nUndo -> Pop `Cmd(B)`.undo(). Stack: [`Cmd(A)`]."
            },
            {
              "question": "How does Command pattern support transaction logging?",
              "answer": "Serialize every Command object to disk before executing. \nIf system crashes, read log and re-execute commands one by one to restore state (Recovery)."
            },
            {
              "question": "Difference between Command and Strategy pattern?",
              "answer": "**Command:** Encapsulates a *request* (action). Used for callbacks, undo, queuing. \n**Strategy:** Encapsulates an *algorithm* (logic). Used for swapping implementations (Sort, Pay)."
            },
            {
              "question": "How to implement macro commands (batch)?",
              "answer": "`MacroCommand` implements `Command`. \nContains `List<Command>`. \n`execute()`: Iterates list and calls execute on each children. \n`undo()`: Iterates list in **reverse** and calls undo on each."
            },
            {
              "question": "How to limit undo history size?",
              "answer": "Use a **Doubly Linked List** or `Deque` with max size. \nWhen pushing new command, if `size > max`, remove the **head** (oldest) element. \nPrevents distinct memory leaks in long-running sessions."
            }
          ]
        },
        {
          "id": "state_composite_patterns",
          "name": "State and Composite Patterns",
          "estimatedHours": 2,
          "description": "Learn State pattern for managing object behavior based on internal state, and Composite for tree structures.",
          "practiceQuestions": [
            {
              "name": "Flatten Nested List Iterator",
              "slug": "flatten-nested-list-iterator",
              "difficulty": "Medium",
              "link": "https://leetcode.com/problems/flatten-nested-list-iterator/"
            }
          ],
          "learningTip": [
            "**State Pattern:** Object alters behavior when its internal state changes. Appears to change class.",
            "**vs Strategy:** State is about *internal* state transitions. Strategy is about *external* algorithm injection.",
            "**Composite Pattern:** Tree structure where Leaf and Composite (Node) share the same interface.",
            "**Recursion:** Composite methods usually call valid functionality on children recursively."
          ],
          "mustNotMiss": [
            "**State Context:** The object having the state. Delegates calls to `currentState`.",
            "**State Transition:** Can be triggered by Context OR by the State object itself.",
            "**Composite Leaf:** The end node (File). Implements operation directly.",
            "**Composite Node:** The container (Folder). Implements operation by looping children.",
            "**Uniformity:** Client treats File and Folder exactly the same (`c.getSize()`)."
          ],
          "resources": [
            "https://refactoring.guru/design-patterns/state",
            "https://refactoring.guru/design-patterns/composite"
          ],
          "interviewQuestions": [
            {
              "question": "Design Vending Machine using State pattern.",
              "answer": "States: `Idle`, `HasMoney`, `Dispensing`, `OutOfStock`. \n`Context` delegates to `currentState.insertCoin()`. \nIdle: accepts -> transition to HasMoney. \nDispensing: rejects coin. \n*Removes massive switch-case logic.*"
            },
            {
              "question": "Design File System using Composite pattern.",
              "answer": "`FileSystemComponent` interface (getSize). \n`File` (Leaf): returns size. \n`Directory` (Composite): contains `List<Component>`. \n`getSize()`: iterates children, sums their sizes. \nClient treats File and Directory uniformly."
            },
            {
              "question": "When to use State vs Strategy pattern?",
              "answer": "**State:** Object changes its OWN class/behavior internally based on state. (Traffic Light). \n**Strategy:** Client injects a specific algorithm. Object behavior is fixed to that strategy until client changes it."
            },
            {
              "question": "How to handle state transitions?",
              "answer": "1. **State-centric:** State classes trigger transition `context.setState(new StateB())`. \n2. **Context-centric:** Context decides `if (result == ok) state = successState`. \nState-centric is more flexible/decoupled."
            },
            {
              "question": "How to calculate total size of directory (Composite)?",
              "answer": "Recursive method in `Directory`: \n`int sum = 0;` \n`for (Component c : children) sum += c.getSize();` \n`return sum;` \nBase case is the `File` returning its own size."
            }
          ]
        }
      ]
    },
    {
      "id": "rate_limiter_lld",
      "name": "Case Study: Rate Limiter",
      "tier": 2,
      "estimatedHours": 3,
      "topics": [
        {
          "id": "design_rate_limiter",
          "name": "Design Rate Limiter",
          "estimatedHours": 3,
          "description": "Design a Rate Limiter library and service - Token Bucket, Leaky Bucket, Sliding Window algorithms, and distributed limiting.",
          "practiceQuestions": [
            {
              "name": "Logger Rate Limiter",
              "slug": "logger-rate-limiter",
              "difficulty": "Easy",
              "link": "https://leetcode.com/problems/logger-rate-limiter/"
            }
          ],
          "learningTip": [
            "**Core Concepts:** Throttling vs Rate Limiting. Soft (delay) vs Hard (reject) limits.",
            "**Algorithms:** Token Bucket (Burst friendly), Leaky Bucket (Constant rate), Sliding Window (Strict).",
            "**Granularity:** Global limit vs Per-User vs Per-IP.",
            "**Distributed:** Redis is key. Lua scripts ensure atomicity."
          ],
          "mustNotMiss": [
            "**Token Bucket:** `RefillRate`, `Capacity`. Tokens added periodically. Request consumes token.",
            "**Leaky Bucket:** Queue with fixed size and fixed drain rate. Drops overflow.",
            "**Sliding Window Log:** Stores timestamps. Precise but expensive (RAM).",
            "**Sliding Window Counter:** Approximation using fixed windows. Efficient.",
            "**HTTP Headers:** `X-RateLimit-Limit`, `X-RateLimit-Remaining`, `Retry-After`."
          ],
          "resources": [
            "https://stripe.com/blog/rate-limiters",
            "https://github.com/donnemartin/system-design-primer#rate-limiter"
          ],
          "interviewQuestions": [
            {
              "question": "Implement Token Bucket algorithm (Thread-Safe).",
              "answer": "Class `TokenBucket`. \nFields: `maxCapacity`, `currentTokens`, `refillRate`, `lastRefillTime`. \n`synchronized tryConsume()`: \n1. Refill tokens based on `(now - lastRefillTime)`. \n2. If `tokens > 0`, decrement and return true. \n3. Else return false."
            },
            {
              "question": "Design the RateLimiter interface for a library.",
              "answer": "`interface RateLimiter { boolean allow(String clientId); }` \n`abstract class RateLimiterBase` implements logic. \n`class TokenBucketLimiter extends RateLimiterBase`. \n`class SlidingWindowLimiter extends RateLimiterBase`. \n**Strategy Pattern** helps switch algorithms easily."
            },
            {
              "question": "How to handle distributed rate limiting (Multiple App Servers)?",
              "answer": "**Sticky Session:** Bad (Load Imbalance). \n**Central Store (Redis):** Good. \n**Race Condition:** Read-Modify-Write is risky. \n**Solution:** Use **Redis Lua Script** to `Get -> Check -> Decr` atomically in one round-trip."
            },
            {
              "question": "Sliding Window Log vs Counter?",
              "answer": "**Log:** Stores EVERY timestamp. Accurate but O(N) memory. \n**Counter:** Fixed windows (12:00-12:01). Lightweight O(1) memory but has 'Edge Case' (burst at 12:00:59 and 12:01:01 allows 2x limit). \n**Hybrid:** Sliding Window Counter (Weighted avg of previous + current window)."
            },
            {
              "question": "How to implement client-side throttling (Backpressure)?",
              "answer": "If server returns `429 Too Many Requests`: \n1. **Exponential Backoff:** Wait 1s, 2s, 4s, 8s. \n2. **Jitter:** Add random noise to prevent 'Thundering Herd'. \n3. **Circuit Breaker:** Stop calling server entirely for a while."
            }
          ]
        }
      ]
    }
  ],
  "recommendedHoursPerWeek": 3
}